<?php
foreach(glob(dirname(dirname(__FILE__)).'/*.php') as $file){
    require_once $file;
}
/**
 * This is a quick unit test for the color.
 * Test Data is from 
 */
class OpticsColorPointTest extends PHPUnit_Framework_TestCase{

	public function testDistanceTo(){
		$data = json_decode($this->testData, TRUE);
		$optics = new Optics(10, 10);
		foreach($data as $row){
			$p = new OpticsColorPoint($optics, array(0, 0, 0));
			$q = new OpticsColorPoint($optics, array(1, 1, 1));

			$p->l = $row['l1'];
			$p->a = $row['a1'];
			$p->b = $row['b1'];

			$q->l = $row['l2'];
			$q->a = $row['a2'];
			$q->b = $row['b2'];

			$dE = $p->distanceTo($q);

			$this->assertTrue(abs($dE - $row['deltaE']) < 0.2, $dE . "\n" . print_r($row, TRUE));
		}
	}

	public $testData = '[
  {
    "l1":50.0000,
    "a1":2.6772,
    "b1":-79.7751,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":2.0425
  },
  {
    "l1":50.0000,
    "a1":3.1571,
    "b1":-77.2803,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":2.8615
  },
  {
    "l1":50.0000,
    "a1":2.8361,
    "b1":-74.0200,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":3.4412
  },
  {
    "l1":50.0000,
    "a1":-1.3802,
    "b1":-84.2814,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":-1.1848,
    "b1":-84.8006,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":-0.9009,
    "b1":-85.5211,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-82.7485,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":0.0000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":-1.0000,
    "b2":2.0000,
    "deltaE":2.3669
  },
  {
    "l1":50.0000,
    "a1":-1.0000,
    "b1":2.0000,
    "l2":50.0000,
    "a2":0.0000,
    "b2":0.0000,
    "deltaE":2.3669
  },
  {
    "l1":50.0000,
    "a1":2.4900,
    "b1":-0.0010,
    "l2":50.0000,
    "a2":-2.4900,
    "b2":0.0009,
    "deltaE":7.1792
  },
  {
    "l1":50.0000,
    "a1":2.4900,
    "b1":-0.0010,
    "l2":50.0000,
    "a2":-2.4900,
    "b2":0.0010,
    "deltaE":7.1792
  },
  {
    "l1":50.0000,
    "a1":2.4900,
    "b1":-0.0010,
    "l2":50.0000,
    "a2":-2.4900,
    "b2":0.0011,
    "deltaE":7.2195
  },
  {
    "l1":50.0000,
    "a1":2.4900,
    "b1":-0.0010,
    "l2":50.0000,
    "a2":-2.4900,
    "b2":0.0012,
    "deltaE":7.2195
  },
  {
    "l1":50.0000,
    "a1":-0.0010,
    "b1":2.4900,
    "l2":50.0000,
    "a2":0.0009,
    "b2":-2.4900,
    "deltaE":4.8045
  },
  {
    "l1":50.0000,
    "a1":-0.0010,
    "b1":2.4900,
    "l2":50.0000,
    "a2":0.0010,
    "b2":-2.4900,
    "deltaE":4.8045
  },
  {
    "l1":50.0000,
    "a1":-0.0010,
    "b1":2.4900,
    "l2":50.0000,
    "a2":0.0011,
    "b2":-2.4900,
    "deltaE":4.7461
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":0.0000,
    "b2":-2.5000,
    "deltaE":4.3065
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":73.0000,
    "a2":25.0000,
    "b2":-18.0000,
    "deltaE":27.1492
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":61.0000,
    "a2":-5.0000,
    "b2":29.0000,
    "deltaE":22.8977
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":56.0000,
    "a2":-27.0000,
    "b2":-3.0000,
    "deltaE":31.9030
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":58.0000,
    "a2":24.0000,
    "b2":15.0000,
    "deltaE":19.4535
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":3.1736,
    "b2":0.5854,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":3.2972,
    "b2":0.0000,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":1.8634,
    "b2":0.5757,
    "deltaE":1.0000
  },
  {
    "l1":50.0000,
    "a1":2.5000,
    "b1":0.0000,
    "l2":50.0000,
    "a2":3.2592,
    "b2":0.3350,
    "deltaE":1.0000
  },
  {
    "l1":60.2574,
    "a1":-34.0099,
    "b1":36.2677,
    "l2":60.4626,
    "a2":-34.1751,
    "b2":39.4387,
    "deltaE":1.2644
  },
  {
    "l1":63.0109,
    "a1":-31.0961,
    "b1":-5.8663,
    "l2":62.8187,
    "a2":-29.7946,
    "b2":-4.0864,
    "deltaE":1.2630
  },
  {
    "l1":61.2901,
    "a1":3.7196,
    "b1":-5.3901,
    "l2":61.4292,
    "a2":2.2480,
    "b2":-4.9620,
    "deltaE":1.8731
  },
  {
    "l1":35.0831,
    "a1":-44.1164,
    "b1":3.7933,
    "l2":35.0232,
    "a2":-40.0716,
    "b2":1.5901,
    "deltaE":1.8645
  },
  {
    "l1":22.7233,
    "a1":20.0904,
    "b1":-46.6940,
    "l2":23.0331,
    "a2":14.9730,
    "b2":-42.5619,
    "deltaE":2.0373
  },
  {
    "l1":36.4612,
    "a1":47.8580,
    "b1":18.3852,
    "l2":36.2715,
    "a2":50.5065,
    "b2":21.2231,
    "deltaE":1.4146
  },
  {
    "l1":90.8027,
    "a1":-2.0831,
    "b1":1.4410,
    "l2":91.1528,
    "a2":-1.6435,
    "b2":0.0447,
    "deltaE":1.4441
  },
  {
    "l1":90.9257,
    "a1":-0.5406,
    "b1":-0.9208,
    "l2":88.6381,
    "a2":-0.8985,
    "b2":-0.7239,
    "deltaE":1.5381
  },
  {
    "l1":6.7747,
    "a1":-0.2908,
    "b1":-2.4247,
    "l2":5.8714,
    "a2":-0.0985,
    "b2":-2.2286,
    "deltaE":0.6377
  },
  {
    "l1":2.0776,
    "a1":0.0795,
    "b1":-1.1350,
    "l2":0.9033,
    "a2":-0.0636,
    "b2":-0.5514,
    "deltaE":0.9082
  }
]';
}
?>
